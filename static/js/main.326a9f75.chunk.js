(this["webpackJsonpmessaging-app"]=this["webpackJsonpmessaging-app"]||[]).push([[0],{127:function(e,t,a){e.exports=a(174)},132:function(e,t,a){},174:function(e,t,a){"use strict";a.r(t);var n=a(0),s=a.n(n),r=a(13),i=a.n(r);a(132),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var o=a(113),c=a(43),l=a(7),p=a.n(l),u=a(12),d=a(71),m=a(14),h=a(15),f=a(18),g=a(16),x=a(19),b=a(209),w=function(){return{buttonstyle:{marginTop:"10px",marginBottom:"10px"},main:{backgroundImage:"linear-gradient(#83a4d4, #b6fbff)",width:"100vw",height:"100vh",display:"flex"},linkstyle:{fontSize:14,cursor:"pointer"},paperstyles:{width:300,margin:"auto",padding:"10px"}}},S=a(17),v=a.n(S),E=a(204),y=a(207),N=a(206),O=a(61),I=a.n(O),k=a(62),F=a.n(k),C=a(218),j=a(208),R=a(210),L=a(50),W=function(e){function t(){var e;return Object(m.a)(this,t),(e=Object(f.a)(this,Object(g.a)(t).call(this))).submitForm=function(t){t.preventDefault(),""!=e.state.email&&""!=e.state.password?e.toDashboard():e.setState({loginerror:"Error: Please enter a username and password."})},e.userInputHandler=function(t){e.setState(Object(d.a)({},t.target.name,t.target.value))},e.toSignup=function(){e.props.history.push("/signup")},e.toDashboard=Object(u.a)(p.a.mark((function t(){return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,L.auth().signInWithEmailAndPassword(e.state.email,e.state.password).then((function(t){e.props.history.push("/dashboard")})).catch((function(t){e.setState({loginerror:t.toString()})}));case 2:case"end":return t.stop()}}),t)}))),e.state={email:"",password:"",currentUser:null,loginerror:""},e}return Object(x.a)(t,e),Object(h.a)(t,[{key:"render",value:function(){var e=this.props.classes;return s.a.createElement("div",{className:e.main},s.a.createElement(E.a,{className:e.paperstyles},s.a.createElement("h1",{align:"center"},"Login Page"),s.a.createElement("form",{onSubmit:this.submitForm},s.a.createElement(N.a,{fullWidth:!0},s.a.createElement("div",null,s.a.createElement(C.a,{htmlFor:"emailInput"},"Enter Your Email"),s.a.createElement(y.a,{fullWidth:!0,name:"email",id:"emailInput",onChange:this.userInputHandler,startAdornment:s.a.createElement(j.a,{position:"start"},s.a.createElement(I.a,null))}))),s.a.createElement(N.a,{fullWidth:!0},s.a.createElement("div",null,s.a.createElement(C.a,{htmlFor:"passwordInput"},"Enter Your Password"),s.a.createElement(y.a,{type:"password",fullWidth:!0,name:"password",id:"passwordInput",onChange:this.userInputHandler,startAdornment:s.a.createElement(j.a,{position:"start"},s.a.createElement(F.a,null))}))),s.a.createElement("h5",null,this.state.loginerror),s.a.createElement(b.a,{className:e.buttonstyle,type:"submit",variant:"contained",color:"primary",fullWidth:!0},"Log In"),s.a.createElement(R.a,{onClick:this.toSignup,className:e.linkstyle},"Sign Up!"))))}}]),t}(s.a.Component),H=v()(w)(W),D=function(){return{buttonstyle:{marginTop:"10px",marginBottom:"10px"},main:{backgroundImage:"linear-gradient(#83a4d4, #b6fbff)",width:"100vw",height:"100vh",display:"flex"},linkstyle:{fontSize:14,cursor:"pointer"},paperstyles:{width:300,margin:"auto",padding:"10px"}}},z=a(50),A=a(109),B=a.n(A),T=a(50),M=function(e){function t(){var e;return Object(m.a)(this,t),(e=Object(f.a)(this,Object(g.a)(t).call(this))).toLogin=function(){e.props.history.push("/login")},e.submitForm=function(t){t.preventDefault(),""!=e.state.firstname&&""!=e.state.lastname?e.state.password===e.state.passwordconf?e.addToFirebase():e.setState({signuperror:"The passwords do not match!"}):e.setState({signuperror:"Please enter your first and last name!"})},e.userInputHandler=function(t){e.setState(Object(d.a)({},t.target.name,t.target.value))},e.addToFirebase=function(){T.auth().createUserWithEmailAndPassword(e.state.email,e.state.password).then((function(t){var a={email:t.user.email,firstname:e.state.firstname,lastname:e.state.lastname};Object(z.firestore)().collection("users").doc(e.state.email).set(a).then(e.props.history.push("/dashboard")),console.log("signup up successfully")})).catch((function(t){e.setState({signuperror:t.toString()}),console.log(t.toString())}))},e.state={firstname:"",lastname:"",email:"",password:"",passwordconf:"",signuperror:""},e}return Object(x.a)(t,e),Object(h.a)(t,[{key:"render",value:function(){var e=this.props.classes;return s.a.createElement("div",{className:e.main},s.a.createElement(E.a,{className:e.paperstyles},s.a.createElement("h1",{align:"center"},"Sign Up!"),s.a.createElement("form",{onSubmit:this.submitForm},s.a.createElement(N.a,{fullWidth:!0},s.a.createElement("div",null,s.a.createElement(C.a,{htmlFor:"firstnameInput"},"First Name"),s.a.createElement(y.a,{fullWidth:!0,name:"firstname",id:"firstnameInput",onChange:this.userInputHandler,startAdornment:s.a.createElement(j.a,{position:"start"},s.a.createElement(I.a,null))}))),s.a.createElement(N.a,{fullWidth:!0},s.a.createElement("div",null,s.a.createElement(C.a,{htmlFor:"lastnameInput"},"Last Name"),s.a.createElement(y.a,{fullWidth:!0,name:"lastname",id:"lastnameInput",onChange:this.userInputHandler,startAdornment:s.a.createElement(j.a,{position:"start"},s.a.createElement(I.a,null))}))),s.a.createElement(N.a,{fullWidth:!0},s.a.createElement("div",null,s.a.createElement(C.a,{htmlFor:"emailInput"},"Enter Your Email"),s.a.createElement(y.a,{fullWidth:!0,name:"email",id:"emailInput",onChange:this.userInputHandler,startAdornment:s.a.createElement(j.a,{position:"start"},s.a.createElement(B.a,null))}))),s.a.createElement(N.a,{fullWidth:!0},s.a.createElement("div",null,s.a.createElement(C.a,{htmlFor:"passwordInput",className:e.inputstyle},"Enter Your Password"),s.a.createElement(y.a,{type:"password",fullWidth:!0,name:"password",id:"passwordInput",onChange:this.userInputHandler,startAdornment:s.a.createElement(j.a,{position:"start"},s.a.createElement(F.a,null))}))),s.a.createElement(N.a,{fullWidth:!0},s.a.createElement("div",null,s.a.createElement(C.a,{htmlFor:"passwordconfInput"},"Confirm Your Password"),s.a.createElement(y.a,{type:"password",fullWidth:!0,name:"passwordconf",id:"passwordconfInput",onChange:this.userInputHandler,startAdornment:s.a.createElement(j.a,{position:"start"},s.a.createElement(F.a,null))}))),s.a.createElement("h5",null,this.state.signuperror),s.a.createElement(b.a,{className:e.buttonstyle,type:"submit",variant:"contained",color:"primary",fullWidth:!0},"Sign Up"),s.a.createElement(R.a,{onClick:this.toLogin,className:e.linkstyle},"Log In!"))))}}]),t}(s.a.Component),U=v()(D)(M),K=function(){return{main:{},list:{top:"80px",boxSizing:"border-box",width:"30vw",zIndex:"-1",position:"fixed",overflow:"auto",height:"calc(100vh - 80px)",background:"#F0F8FF",left:"0",borderRight:"1px solid grey"},listItemContainer:{backgroundColor:"red",borderColor:"red"},listItemUnread:{fontWeight:"900",marginRight:"30px"},unread:{background:"#DBDBDB"},unreadDot:{color:"#1976d2",marginLeft:"300px",marginRight:"10px"}}},P=a(213),Y=a(214),V=a(215),G=function(){return{main:{padding:"10px",display:"flex",justifyContent:"space-around",alignItems:"center",background:"#F0F8FF",height:"80px",position:"fixed",width:"30vw",borderRight:"1px solid grey",zIndex:"1",boxSizing:"border-box"},autocompletestyles:{width:"300px",padding:"20px"},createstyles:{fontSize:"30px"},iconbuttonstyles:{width:"70px",borderRadius:"10px","&:hover":{},marginRight:"20px"}}},J=a(212),X=a(112),Z=a.n(X),Q=a(216),$=a(217),q=function(e){function t(){var e;return Object(m.a)(this,t),(e=Object(f.a)(this,Object(g.a)(t).call(this))).onChangeHandler=function(){var t=Object(u.a)(p.a.mark((function t(a,n,s){var r,i;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!n){t.next=17;break}if("select-option"!=s){t.next=17;break}return r=e.props.chats.map((function(t){return t.users.filter((function(t){return t!=e.props.currentuser}))[0]})),i=r.indexOf(n.email),console.log(i),t.next=7,e.props.setSelectedchatIndex(i);case 7:return t.next=9,e.props.setSelectedmessages();case 9:return t.next=11,e.props.changeSelectedIndexofChatSelector(i);case 11:return t.next=13,e.props.setSelectedFirstName(n.firstname);case 13:return t.next=15,e.props.setSelectedLastName(n.lastname);case 15:return t.next=17,e.props.setHasRead();case 17:case"end":return t.stop()}}),t)})));return function(e,a,n){return t.apply(this,arguments)}}(),e.handleNewMessageClick=function(){e.props.displayNewChatWindow(),e.props.setHasSelectedOnce()},e.state={autocompleteValue:""},e}return Object(x.a)(t,e),Object(h.a)(t,[{key:"render",value:function(){var e=this,t=this.props.classes,a=this.props.chats.map((function(t){return t.users.filter((function(t){return t!=e.props.currentuser}))[0]})),n=this.props.users.filter((function(e){return a.includes(e.email)}));return console.log(this.props.chats),s.a.createElement("div",{className:t.main},s.a.createElement($.a,{clearOnEscape:!0,value:this.state.autocompleteValue,id:"selector-friends-list",options:n,getOptionLabel:function(e){return e.firstname?[e.firstname,e.lastname].join(" "):e},className:t.autocompletestyles,onChange:function(t,a,n){return e.onChangeHandler(t,a,n)},edge:"start",renderInput:function(e){return s.a.createElement(Q.a,Object.assign({},e,{label:"Search Friends",variant:"outlined"}))}}),s.a.createElement(J.a,{className:t.iconbuttonstyles,onClick:this.handleNewMessageClick,color:"primary"},s.a.createElement(Z.a,{className:t.createstyles})))}}]),t}(s.a.Component),_=v()(G)(q),ee=function(){return{main:{display:"flex",alignItems:"center"},avatar:{marginLeft:"35px",boxSizing:"border-box",height:"50px",width:"50px"},name:{marginLeft:"20px",boxSizing:"border-box"}}},te=a(219),ae=function(e){function t(){return Object(m.a)(this,t),Object(f.a)(this,Object(g.a)(t).apply(this,arguments))}return Object(x.a)(t,e),Object(h.a)(t,[{key:"render",value:function(){var e=this.props.classes;return s.a.createElement("div",null,s.a.createElement("div",{className:e.main},s.a.createElement(te.a,{className:e.avatar},this.props.firstinit+this.props.lastinit),s.a.createElement("div",{className:e.name},this.props.fullname)))}}]),t}(s.a.Component),ne=v()(ee)(ae),se=a(57),re=function(e){function t(){var e;return Object(m.a)(this,t),(e=Object(f.a)(this,Object(g.a)(t).call(this))).wasLastSender=function(t){return t.messages[t.messages.length-1].sender===e.props.currentuser},e.setFullName=function(t){var a=t.users.filter((function(t){return t!==e.props.currentuser})),n=e.props.users.filter((function(e){return a.includes(e.email)})),r=n.map((function(e){return e.firstname})).toString(),i=r.charAt(0),o=n.map((function(e){return e.lastname})).toString(),c=o.charAt(0);return s.a.createElement(ne,{firstinit:i,lastinit:c,fullname:r+" "+o})},e.handleListItemClick=function(){var t=Object(u.a)(p.a.mark((function t(a){return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.setState({selectedIndex:a});case 2:return t.next=4,e.props.setSelectedchatIndex(a);case 4:return t.next=6,e.props.setSelectedmessages();case 6:return t.next=8,e.setSelectedFirstandLastName(a);case 8:return t.next=10,e.props.setHasRead();case 10:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.setSelectedIndex=function(){var t=Object(u.a)(p.a.mark((function t(a){return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.setState({selectedIndex:a});case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.setSelectedFirstandLastName=function(){var t=Object(u.a)(p.a.mark((function t(a){var n,s,r;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.props.chats.map((function(t){return t.users.filter((function(t){return t!=e.props.currentuser}))[0]})),s=e.props.users,r=s.filter((function(e){return n.includes(e.email)})),console.log(r),t.next=6,e.props.setSelectedFirstName(r[a].firstname);case 6:return t.next=8,e.props.setSelectedLastName(r[a].lastname);case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.state={email:"",selectedIndex:null},e}return Object(x.a)(t,e),Object(h.a)(t,[{key:"render",value:function(){var e=this,t=this.props.classes;return s.a.createElement("div",{className:t.main},s.a.createElement(_,{displayNewChatWindow:this.props.displayNewChatWindow,setHasSelectedOnce:this.props.setHasSelectedOnce,chats:this.props.chats,users:this.props.users,currentuser:this.props.currentuser,setSelectedchatIndex:this.props.setSelectedchatIndex,setSelectedmessages:this.props.setSelectedmessages,changeSelectedIndexofChatSelector:this.props.changeSelectedIndexofChatSelector,setSelectedFirstName:this.props.setSelectedFirstName,setSelectedLastName:this.props.setSelectedLastName,setHasRead:this.props.setHasRead}),s.a.createElement("div",{className:t.list},s.a.createElement(P.a,null,this.props.chats.map((function(a,n){return console.log(a.hasRead),console.log(e.wasLastSender(a)),0==a.hasRead&&0==e.wasLastSender(a)?s.a.createElement("div",{key:n},s.a.createElement(Y.a,{button:!0,selected:e.state.selectedIndex===n,onClick:function(t){e.handleListItemClick(n)},className:t.unread},s.a.createElement(V.a,{primary:s.a.createElement("div",null,s.a.createElement(se.a,{className:t.listItemUnread},e.setFullName(a)))}))):s.a.createElement("div",{key:n},s.a.createElement(Y.a,{button:!0,selected:e.state.selectedIndex===n,onClick:function(t){e.handleListItemClick(n)}},s.a.createElement(V.a,{primary:e.setFullName(a)})))})))))}}]),t}(s.a.Component),ie=v()(K)(re),oe=function(){return{main:{margin:0,padding:0,background:"red"},title:{background:"red"},testscroll:{margin:"20px",width:"70%",marginLeft:"30%",position:"absolute",top:"100px",overflowY:"scroll"}}},ce=a(90),le=function(){return{convoheader:{width:"70vw",height:"80px",marginLeft:"30%",background:"#F0FFFF",padding:"20px",position:"fixed",zIndex:"1",boxSizing:"border-box"},messages:{display:"flex",flexDirection:"column-reverse",alignItems:"center",width:"70vw",marginLeft:"30%",position:"absolute",top:"80px",overflow:"auto",height:"calc(100vh - 150px)",background:"#FFFFFE",boxSizing:"border-box",border:"10px #FFFFFE solid"},messagesUser:{width:"30%",background:"#1976d2",float:"right",clear:"both",padding:"20px",borderRadius:"15px",marginLeft:"65%",wordWrap:"break-word",boxSizing:"border-box",marginTop:"10px",color:"#FFFFFD"},messagesOther:{width:"30%",background:"#EBECE4",float:"left",clear:"both",padding:"20px",borderRadius:"15px",marginRight:"65%",wordWrap:"break-word",boxSizing:"border-box",marginTop:"10px"}}},pe=function(){return{convoheader:{width:"70vw",height:"80px",marginLeft:"30%",background:"#F0F8FF",padding:"20px",position:"fixed",zIndex:"1",boxSizing:"border-box",display:"flex",alignItems:"center",justifyContent:"space-between",borderBottom:"1px solid grey"},messages:{display:"flex",flexDirection:"column-reverse",alignItems:"center",width:"70vw",marginLeft:"30%",position:"absolute",top:"80px",overflow:"auto",height:"calc(100vh - 130px)",background:"yellow",boxSizing:"border-box",border:"10px yellow solid"},messagesUser:{width:"30%",background:"coral",float:"right",clear:"both",padding:"20px",borderRadius:"15px",marginLeft:"65%",wordWrap:"break-word",boxSizing:"border-box",marginTop:"10px"},messagesOther:{width:"30%",background:"lightgreen",float:"left",clear:"both",padding:"20px",borderRadius:"15px",marginRight:"65%",wordWrap:"break-word",boxSizing:"border-box",marginTop:"10px"},autocompletestyles:{width:"1000px",float:"left",marginleft:"-400px"},buttoncontainer:{marginLeft:"50px",marginRight:"0px"},button:{height:"40px",width:"100px"}}},ue=function(e){function t(){var e;return Object(m.a)(this,t),(e=Object(f.a)(this,Object(g.a)(t).call(this))).handleClose=function(){var t=Object(u.a)(p.a.mark((function t(a,n,s){var r,i,o,c,l,u;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("blur"!=s){t.next=10;break}return console.log(s),r=document.getElementById("friends-list"),i=r.getAttribute("value").trim(),t.next=6,e.setState({recipient:i});case 6:if(o=e.props.chats.map((function(t){return t.users.filter((function(t){return t!=e.props.currentuser}))[0]})),n!=e.props.currentuser){t.next=9;break}return t.abrupt("return");case 9:1==o.includes(i)?(c=o.indexOf(e.state.recipient),e.props.setSelectedchatIndex(c),e.props.setSelectedmessages(),e.props.changeSelectedIndexofChatSelector(c),l=e.props.users,u=l.filter((function(e){return o.includes(e.email)})),e.props.setSelectedFirstName(u[c].firstname),e.props.setSelectedLastName(u[c].lastname),e.props.setHasRead()):(e.props.setNewRecipient(e.state.recipient),console.log(i),console.log(e.state.recipient));case 10:case"end":return t.stop()}}),t)})));return function(e,a,n){return t.apply(this,arguments)}}(),e.onChangeHandler=function(){var t=Object(u.a)(p.a.mark((function t(a,n,s){var r,i,o,c,l,u,d,m;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!n){t.next=54;break}if("Enter"!==a.key){t.next=27;break}if((n=n.trim())!=e.props.currentuser){t.next=5;break}return t.abrupt("return");case 5:return t.next=7,e.setState({recipient:n});case 7:if(1!=(r=e.props.chats.map((function(t){return t.users.filter((function(t){return t!=e.props.currentuser}))[0]}))).includes(n)){t.next=20;break}i=r.indexOf(n),e.props.setSelectedchatIndex(i),e.props.setSelectedmessages(),e.props.changeSelectedIndexofChatSelector(i),o=e.props.users,c=o.filter((function(e){return r.includes(e.email)})),e.props.setSelectedFirstName(c[i].firstname),e.props.setSelectedLastName(c[i].lastname),e.props.setHasRead(),t.next=25;break;case 20:return t.next=22,e.setState({recipient:n});case 22:e.props.setNewRecipient(e.state.recipient),console.log(n),console.log(e.state.recipient);case 25:t.next=54;break;case 27:if("select-option"!=s){t.next=47;break}return e.props.setKnownRecipient(!0),t.next=31,e.setState({recipient:n.email});case 31:l=e.props.chats.map((function(t){return t.users.filter((function(t){return t!=e.props.currentuser}))[0]})),u=l.indexOf(e.state.recipient),e.props.setSelectedchatIndex(u),e.props.setSelectedmessages(),e.props.changeSelectedIndexofChatSelector(u),d=e.props.users,m=d.filter((function(e){return l.includes(e.email)})),e.props.setSelectedFirstName(m[u].firstname),e.props.setSelectedLastName(m[u].lastname),e.props.setHasRead(),console.log(s),console.log(n),console.log(e.state.recipient),console.log(u),t.next=54;break;case 47:return e.props.setKnownRecipient(!1),t.next=50,e.setState({recipient:n});case 50:e.props.setNewRecipient(e.state.recipient),console.log(s),console.log(n),console.log(e.state.recipient);case 54:case"end":return t.stop()}}),t)})));return function(e,a,n){return t.apply(this,arguments)}}(),e.componentDidMount=function(){e.props.setKnownRecipient(!1),e.props.changeSelectedIndexofChatSelector(null)},e.state={recipient:""},e}return Object(x.a)(t,e),Object(h.a)(t,[{key:"render",value:function(){var e=this,t=this.props.classes,a=this.props.chats.map((function(t){return t.users.filter((function(t){return t!=e.props.currentuser}))[0]})),n=this.props.users.filter((function(e){return a.includes(e.email)}));return s.a.createElement("div",null,s.a.createElement("div",{className:t.convoheader},s.a.createElement($.a,{id:"friends-list",freeSolo:!0,clearOnEscape:!0,options:n,getOptionLabel:function(e){return e.firstname?[e.firstname,e.lastname].join(" "):e},className:t.autocompletestyles,edge:"start",onChange:function(t,a,n){return e.onChangeHandler(t,a,n)},onClose:function(t,a){e.handleClose(t,e.state.recipient,a)},renderInput:function(e){return s.a.createElement(Q.a,Object.assign({},e,{label:"To:",variant:"outlined"}))}}),s.a.createElement("div",{className:t.buttoncontainer},s.a.createElement(b.a,{color:"primary",variant:"contained",className:t.button,onClick:this.props.logout},"Log Out"))))}}]),t}(s.a.Component),de=v()(pe)(ue),me=function(){return{main:{width:"70vw",height:"80px",marginLeft:"30%",background:"#F0F8FF",padding:"20px",position:"fixed",zIndex:"1",boxSizing:"border-box",display:"flex",alignItems:"center",justifyContent:"space-between",borderBottom:"1px solid grey"},avataruserWrapper:{display:"flex",alignItems:"center"},avatar:{padding:"20px",boxSizing:"border-box",height:"50px",width:"50px"},name:{padding:"20px",boxSizing:"border-box"}}},he=function(e){function t(){return Object(m.a)(this,t),Object(f.a)(this,Object(g.a)(t).apply(this,arguments))}return Object(x.a)(t,e),Object(h.a)(t,[{key:"render",value:function(){var e=this.props.classes;return s.a.createElement("div",null,this.props.hasSelectedOnce?s.a.createElement("div",{className:e.main},s.a.createElement("div",{className:e.avataruserWrapper},s.a.createElement(te.a,{className:e.avatar},this.props.firstname.charAt(0)+this.props.lastname.charAt(0)),s.a.createElement("div",{className:e.name},this.props.firstname+" "+this.props.lastname)),s.a.createElement(b.a,{color:"primary",variant:"contained",className:e.button,onClick:this.props.logout},"Log Out")):s.a.createElement("div",{className:e.main},s.a.createElement("div",{className:e.avataruserWrapper}," "),s.a.createElement(b.a,{color:"primary",variant:"contained",className:e.button,onClick:this.props.logout},"Log Out")))}}]),t}(s.a.Component),fe=v()(me)(he),ge=function(e){function t(){var e;return Object(m.a)(this,t),(e=Object(f.a)(this,Object(g.a)(t).call(this))).setKnownRecipient=function(){var t=Object(u.a)(p.a.mark((function t(a){return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.setState({knownRecipient:a});case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.componentDidMount=function(){var e=document.getElementById("convodisplay");e&&e.scrollTo(0,e.scrollHeight)},e.componentDidUpdate=function(){var e=document.getElementById("convodisplay");e&&e.scrollTo(0,e.scrollHeight)},e.state={knownRecipient:!1},e}return Object(x.a)(t,e),Object(h.a)(t,[{key:"render",value:function(){var e=this,t=this.props.classes;return s.a.createElement("div",null,this.props.newChatWindow?s.a.createElement("div",null,s.a.createElement(de,{chats:this.props.chats,users:this.props.users,currentuser:this.props.currentuser,setKnownRecipient:this.setKnownRecipient,setSelectedchatIndex:this.props.setSelectedchatIndex,setSelectedmessages:this.props.setSelectedmessages,changeSelectedIndexofChatSelector:this.props.changeSelectedIndexofChatSelector,setNewRecipient:this.props.setNewRecipient,setSelectedFirstName:this.props.setSelectedFirstName,setSelectedLastName:this.props.setSelectedLastName,logout:this.props.logout,setHasRead:this.props.setHasRead}),this.state.knownRecipient?s.a.createElement("div",{className:t.messages,id:"convodisplay"},Object(ce.a)(this.props.selectedmessages).reverse().map((function(a,n){return a.sender===e.props.email?s.a.createElement("div",{className:t.messagesUser,key:n},a.message):s.a.createElement("div",{className:t.messagesOther,key:n},a.message)}))):s.a.createElement("div",{className:t.messages})):s.a.createElement("div",null,s.a.createElement("div",{align:"center"},s.a.createElement(fe,{className:t.convoheader,firstname:this.props.selectedFirstName,lastname:this.props.selectedLastName,hasSelectedOnce:this.props.hasSelectedOnce,logout:this.props.logout})),s.a.createElement("div",{className:t.messages,id:"convodisplay"},Object(ce.a)(this.props.selectedmessages).reverse().map((function(a,n){return a.sender===e.props.email?s.a.createElement("div",{className:t.messagesUser,key:n},a.message):s.a.createElement("div",{className:t.messagesOther,key:n},a.message)})))))}}]),t}(s.a.Component),xe=v()(le)(ge),be=function(){return{main:{width:"70vw",marginLeft:"30%",padding:"10px",position:"fixed",zIndex:"1",bottom:0,height:"70px",boxSizing:"border-box",display:"flex",justifyContent:"space-between",alignItems:"center",borderTop:"1px solid grey",background:"#F0F8FF"},chatTextBox:{width:"87%",marginLeft:"30px",marginRight:"30px",border:"1px solid grey",borderRadius:"5px",padding:"5px"},buttonstyle:{height:"40px"}}},we=function(e){function t(){var e;return Object(m.a)(this,t),(e=Object(f.a)(this,Object(g.a)(t).call(this))).onFocusHandler=function(){e.props.setHasRead()},e.onKeyDownHandler=function(t){"Enter"===t.key&&e.sendMessage()},e.sendMessage=Object(u.a)(p.a.mark((function t(){return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.props.sendMessage(e.state.message),t.next=3,e.setState({message:""});case 3:case"end":return t.stop()}}),t)}))),e.handleInputChange=function(){var t=Object(u.a)(p.a.mark((function t(a){return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.setState({message:a.target.value});case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.state={message:""},e}return Object(x.a)(t,e),Object(h.a)(t,[{key:"render",value:function(){var e=this.props.classes;return s.a.createElement("div",{className:e.main},s.a.createElement(Q.a,{id:"chatTextBox",className:e.chatTextBox,onChange:this.handleInputChange,value:this.state.message,onKeyDown:this.onKeyDownHandler,autoComplete:"off",onFocus:this.onFocusHandler}),s.a.createElement(b.a,{color:"primary",variant:"contained",onClick:this.sendMessage},"Send"))}}]),t}(s.a.Component),Se=v()(be)(we),ve=a(50),Ee=function(e){function t(){var e;return Object(m.a)(this,t),(e=Object(f.a)(this,Object(g.a)(t).call(this))).setHasRead=function(){var t=e.getDocName(),a=e.state.chats[e.state.selectedchatIndex].messages.length,n=e.state.chats[e.state.selectedchatIndex].messages[a-1].sender;console.log(n),n!==e.state.email?ve.firestore().collection("chats").doc(t).update({hasRead:!0}):console.log("I sent the last message")},e.logout=function(){ve.auth().signOut(),e.props.history.push("/login"),console.log("loggedout")},e.setSelectedFirstName=function(){var t=Object(u.a)(p.a.mark((function t(a){return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.setState({selectedFirstName:a});case 2:console.log(e.state.selectedFirstName);case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.setSelectedLastName=function(){var t=Object(u.a)(p.a.mark((function t(a){return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.setState({selectedLastName:a});case 2:console.log(e.state.selectedLastName);case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.setNewRecipient=function(){var t=Object(u.a)(p.a.mark((function t(a){return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.setState({newRecipient:a});case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.changeSelectedIndexofChatSelector=function(t){e.chatSelectorComponent.current.setSelectedIndex(t)},e.displayNewChatWindow=Object(u.a)(p.a.mark((function t(){return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.setState({newChatWindow:!0});case 2:case"end":return t.stop()}}),t)}))),e.sendMessage=function(){var t=Object(u.a)(p.a.mark((function t(a){var n,s;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(1!=e.state.newChatWindow){t.next=22;break}return console.log("newchatwindow"),console.log(e.state.newRecipient),t.next=5,e.validRecipient();case 5:if(!t.sent){t.next=19;break}if(!a.replace(/\s/g,"").length){t.next=17;break}return n=e.buildNewRecipientDocName(),t.next=10,ve.firestore().collection("chats").doc(n).set({messages:[{message:a,sender:e.state.email,timestamp:Date.now()}],users:[e.state.email,e.state.newRecipient],hasRead:!1});case 10:return e.changeSelectedIndexofChatSelector(e.findIndexOfRecipient(e.state.newRecipient)),t.next=13,e.setState({newChatWindow:!1});case 13:e.setSelectedchatIndex(e.findIndexOfRecipient(e.state.newRecipient)),e.setSelectedmessages(),console.log(e.findIndexOfRecipient(e.state.newRecipient)),e.setFirstAndLastName(e.findIndexOfRecipient(e.state.newRecipient));case 17:t.next=20;break;case 19:console.log("NOT A VALID EMAIL");case 20:t.next=23;break;case 22:a.replace(/\s/g,"").length&&(s=e.getDocName(),ve.firestore().collection("chats").doc(s).update({messages:ve.firestore.FieldValue.arrayUnion({message:a,sender:e.state.email,timestamp:Date.now()}),hasRead:!1}).then(console.log("Message Sent")));case 23:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.setFirstAndLastName=function(t){var a=e.state.chats.map((function(t){return t.users.filter((function(t){return t!=e.state.email}))[0]})),n=e.state.users.filter((function(e){return a.includes(e.email)}));e.setSelectedFirstName(n[t].firstname),e.setSelectedLastName(n[t].lastname)},e.findIndexOfRecipient=function(t){return e.state.chats.map((function(t){return t.users.filter((function(t){return t!=e.state.email}))[0]})).indexOf(t)},e.buildNewRecipientDocName=function(){return[e.state.email,e.state.newRecipient].sort().join(":")},e.validRecipient=Object(u.a)(p.a.mark((function t(){var a,n,s;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,ve.firestore().collection("users").get();case 2:return a=t.sent,n=a.docs.map((function(e){return e.data().email})),s=n.includes(e.state.newRecipient),console.log(s),t.abrupt("return",s);case 7:case"end":return t.stop()}}),t)}))),e.getDocName=function(){var t=e.state.chats[e.state.selectedchatIndex].users.filter((function(t){return t!=e.state.email}));return[e.state.email,t].sort().join(":")},e.setHasSelectedOnce=Object(u.a)(p.a.mark((function t(){return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.setState({hasSelectedOnce:!0});case 2:case"end":return t.stop()}}),t)}))),e.setSelectedchatIndex=function(t){e.setState({selectedchatIndex:t}),e.setHasSelectedOnce(),e.setState({newChatWindow:!1}),console.log(e.state.chats[e.state.selectedchatIndex].users)},e.setSelectedmessages=function(){e.setState({selectedmessages:e.state.chats[e.state.selectedchatIndex].messages})},e.componentWillMount=function(){ve.auth().onAuthStateChanged(function(){var t=Object(u.a)(p.a.mark((function t(a){return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!a){t.next=7;break}return e.setState({email:a.email}),console.log(a.email),t.next=5,ve.firestore().collection("chats").where("users","array-contains",a.email).onSnapshot(function(){var t=Object(u.a)(p.a.mark((function t(a){var n;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=a.docs.map((function(e){return e.data()})),t.next=3,e.setState({chats:n});case 3:!0===e.state.hasSelectedOnce&&e.setSelectedmessages();case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());case 5:return t.next=7,ve.firestore().collection("users").onSnapshot(function(){var t=Object(u.a)(p.a.mark((function t(a){var n;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=a.docs.map((function(e){return e.data()})),t.next=3,e.setState({users:n});case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())},e.state={email:"",users:[],chats:[],selectedchatIndex:0,selectedmessages:[],hasSelectedOnce:!1,newChatWindow:!0,newRecipient:"",selectedFirstName:"",selectedLastName:""},e.chatSelectorComponent=s.a.createRef(),e}return Object(x.a)(t,e),Object(h.a)(t,[{key:"render",value:function(){var e=this.props.classes;return this.state.email?s.a.createElement("div",{className:e.main},s.a.createElement(ie,{chats:this.state.chats,currentuser:this.state.email,setSelectedchatIndex:this.setSelectedchatIndex,setSelectedmessages:this.setSelectedmessages,changeSelectedIndexofChatSelector:this.changeSelectedIndexofChatSelector,displayNewChatWindow:this.displayNewChatWindow,setHasSelectedOnce:this.setHasSelectedOnce,users:this.state.users,ref:this.chatSelectorComponent,setSelectedFirstName:this.setSelectedFirstName,setSelectedLastName:this.setSelectedLastName,setHasRead:this.setHasRead}),s.a.createElement(xe,{email:this.state.email,selectedmessages:this.state.selectedmessages,chats:this.state.chats,users:this.state.users,currentuser:this.state.email,newChatWindow:this.state.newChatWindow,setSelectedchatIndex:this.setSelectedchatIndex,setSelectedmessages:this.setSelectedmessages,changeSelectedIndexofChatSelector:this.changeSelectedIndexofChatSelector,setNewRecipient:this.setNewRecipient,selectedFirstName:this.state.selectedFirstName,selectedLastName:this.state.selectedLastName,setSelectedFirstName:this.setSelectedFirstName,setSelectedLastName:this.setSelectedLastName,hasSelectedOnce:this.state.hasSelectedOnce,logout:this.logout,setHasRead:this.setHasRead}),s.a.createElement(Se,{sendMessage:this.sendMessage,hasSelectedOnce:this.state.hasSelectedOnce,newChatWindow:this.state.newChatWindow,setHasRead:this.setHasRead})):s.a.createElement("div",null)}}]),t}(s.a.Component),ye=v()(oe)(Ee),Ne=a(50);a(172),Ne.initializeApp({apiKey:"AIzaSyBF3SHP38ZZGBEGhmmiXD-N50MwE6taL7w",authDomain:"messaging-app-dc03d.firebaseapp.com",databaseURL:"https://messaging-app-dc03d.firebaseio.com",projectId:"messaging-app-dc03d",storageBucket:"messaging-app-dc03d.appspot.com",messagingSenderId:"462664318963",appId:"1:462664318963:web:abef1551f827da1da09c86",measurementId:"G-XPQFN9TSD9"});var Oe=s.a.createElement(o.a,null,s.a.createElement("div",{id:"routing-container"},s.a.createElement(c.a,{path:"/",exact:!0,component:H}),s.a.createElement(c.a,{path:"/login",component:H}),s.a.createElement(c.a,{path:"/signup",component:U}),s.a.createElement(c.a,{path:"/dashboard",component:ye})));i.a.render(Oe,document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[127,1,2]]]);
//# sourceMappingURL=main.326a9f75.chunk.js.map